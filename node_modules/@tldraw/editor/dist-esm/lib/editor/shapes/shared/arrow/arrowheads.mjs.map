{
  "version": 3,
  "sources": ["../../../../../../src/lib/editor/shapes/shared/arrow/arrowheads.ts"],
  "sourcesContent": ["import { Vec2d, VecLike } from '../../../../primitives/Vec2d'\nimport { intersectCircleCircle } from '../../../../primitives/intersect'\nimport { PI, TAU } from '../../../../primitives/utils'\nimport { TLArrowInfo } from './arrow-types'\n\ntype TLArrowPointsInfo = {\n\tpoint: VecLike\n\tint: VecLike\n}\n\nfunction getArrowPoints(\n\tinfo: TLArrowInfo,\n\tside: 'start' | 'end',\n\tstrokeWidth: number\n): TLArrowPointsInfo {\n\tconst PT = side === 'end' ? info.end.point : info.start.point\n\tconst PB = side === 'end' ? info.start.point : info.end.point\n\n\tconst compareLength = info.isStraight ? Vec2d.Dist(PB, PT) : Math.abs(info.bodyArc.length) // todo: arc length for curved arrows\n\n\tconst length = Math.max(Math.min(compareLength / 5, strokeWidth * 3), strokeWidth)\n\n\tlet P0: VecLike\n\n\tif (info.isStraight) {\n\t\tP0 = Vec2d.Nudge(PT, PB, length)\n\t} else {\n\t\tconst ints = intersectCircleCircle(PT, length, info.handleArc.center, info.handleArc.radius)\n\t\tP0 =\n\t\t\tside === 'end'\n\t\t\t\t? info.handleArc.sweepFlag\n\t\t\t\t\t? ints[0]\n\t\t\t\t\t: ints[1]\n\t\t\t\t: info.handleArc.sweepFlag\n\t\t\t\t? ints[1]\n\t\t\t\t: ints[0]\n\t}\n\n\treturn {\n\t\tpoint: PT,\n\t\tint: P0,\n\t}\n}\n\nexport function getArrowhead({ point, int }: TLArrowPointsInfo) {\n\tconst PL = Vec2d.RotWith(int, point, PI / 6)\n\tconst PR = Vec2d.RotWith(int, point, -PI / 6)\n\n\treturn `M ${PL.x} ${PL.y} L ${point.x} ${point.y} L ${PR.x} ${PR.y}`\n}\n\nexport function getTriangleHead({ point, int }: TLArrowPointsInfo) {\n\tconst PL = Vec2d.RotWith(int, point, PI / 6)\n\tconst PR = Vec2d.RotWith(int, point, -PI / 6)\n\n\treturn `M ${PL.x} ${PL.y} L ${point.x} ${point.y} L ${PR.x} ${PR.y} Z`\n}\n\nexport function getInvertedTriangleHead({ point, int }: TLArrowPointsInfo) {\n\tconst d = Vec2d.Sub(int, point).div(2)\n\tconst PL = Vec2d.Add(point, Vec2d.Rot(d, TAU))\n\tconst PR = Vec2d.Sub(point, Vec2d.Rot(d, TAU))\n\n\treturn `M ${PL.x} ${PL.y} L ${int.x} ${int.y} L ${PR.x} ${PR.y} Z`\n}\n\nexport function getDotHead({ point, int }: TLArrowPointsInfo) {\n\tconst A = Vec2d.Lrp(point, int, 0.45)\n\tconst r = Vec2d.Dist(A, point)\n\n\treturn `M ${A.x - r},${A.y}\n  a ${r},${r} 0 1,0 ${r * 2},0\n  a ${r},${r} 0 1,0 -${r * 2},0 `\n}\n\nexport function getDiamondHead({ point, int }: TLArrowPointsInfo) {\n\tconst PB = Vec2d.Lrp(point, int, 0.75)\n\tconst PL = Vec2d.RotWith(PB, point, PI / 4)\n\tconst PR = Vec2d.RotWith(PB, point, -PI / 4)\n\n\tconst PQ = Vec2d.Lrp(PL, PR, 0.5)\n\tPQ.add(Vec2d.Sub(PQ, point))\n\n\treturn `M ${PQ.x} ${PQ.y} L ${PL.x} ${PL.y} ${point.x} ${point.y} L ${PR.x} ${PR.y} Z`\n}\n\nexport function getSquareHead({ int, point }: TLArrowPointsInfo) {\n\tconst PB = Vec2d.Lrp(point, int, 0.85)\n\tconst d = Vec2d.Sub(PB, point).div(2)\n\tconst PL1 = Vec2d.Add(point, Vec2d.Rot(d, TAU))\n\tconst PR1 = Vec2d.Sub(point, Vec2d.Rot(d, TAU))\n\tconst PL2 = Vec2d.Add(PB, Vec2d.Rot(d, TAU))\n\tconst PR2 = Vec2d.Sub(PB, Vec2d.Rot(d, TAU))\n\n\treturn `M ${PL1.x} ${PL1.y} L ${PL2.x} ${PL2.y} L ${PR2.x} ${PR2.y} L ${PR1.x} ${PR1.y} Z`\n}\n\nexport function getBarHead({ int, point }: TLArrowPointsInfo) {\n\tconst d = Vec2d.Sub(int, point).div(2)\n\n\tconst PL = Vec2d.Add(point, Vec2d.Rot(d, TAU))\n\tconst PR = Vec2d.Sub(point, Vec2d.Rot(d, TAU))\n\n\treturn `M ${PL.x} ${PL.y} L ${PR.x} ${PR.y}`\n}\n\nexport function getPipeHead() {\n\treturn ''\n}\n\n/** @public */\nexport function getArrowheadPathForType(\n\tinfo: TLArrowInfo,\n\tside: 'start' | 'end',\n\tstrokeWidth: number\n): string | undefined {\n\tconst type = side === 'end' ? info.end.arrowhead : info.start.arrowhead\n\tif (type === 'none') return\n\n\tconst points = getArrowPoints(info, side, strokeWidth)\n\tif (!points) return\n\n\tswitch (type) {\n\t\tcase 'bar':\n\t\t\treturn getBarHead(points)\n\t\tcase 'square':\n\t\t\treturn getSquareHead(points)\n\t\tcase 'diamond':\n\t\t\treturn getDiamondHead(points)\n\t\tcase 'dot':\n\t\t\treturn getDotHead(points)\n\t\tcase 'inverted':\n\t\t\treturn getInvertedTriangleHead(points)\n\t\tcase 'arrow':\n\t\t\treturn getArrowhead(points)\n\t\tcase 'triangle':\n\t\t\treturn getTriangleHead(points)\n\t}\n\n\treturn ''\n}\n"],
  "mappings": "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",
  "names": []
}
